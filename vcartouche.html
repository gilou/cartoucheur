<!DOCTYPE html>
<html>
        <head>
		<script src="https://unpkg.com/vue"></script>
		<link rel="stylesheet" href="style.css" />
	</head>
        <body>
		<script type="text/x-template" id="player-template">
		<div class="chargeur">
		<slot name="player">
			<button @click="click" class="cartouche">
				<audio :src='mysource' ref='player'></audio>
			{{ mytitle }}
			</button>
		</slot>
		<slot name="file"><input @change="filechanged" type="file" ref='file' /></slot>
		</div>
		</script>
		<div id="player">
			<div slot="player" class="cartoucheur">
				<player v-for="i in 10" title='Click me' :key="i"></player>
			</div>
			<p>{{ message }}</p>
		</div>
                <script>
Vue.component('player', {
  template: '#player-template',
  props: {
    title: String,
  }, 
  data: function () {
	  return {
		  mytitle: this.title,
		  mysource: undefined,
		  myfile: '',
	  }
  },
  methods: {
    filechanged: function(event) {
      file = event.target.files[0]
      url = URL.createObjectURL(file)
      var a = new Audio()
      if(a.canPlayType(file.type)) { 
        this.mysource = url
        this.mytitle = file.name
      } else {
        console.log("Can't read this.")
      }
    },
    click: function(event) {
      if(this.mysource === undefined || this.mysource == '') {
        this.$refs.file.click()
      }
      else {
        player = this.$refs.player
	if(player.paused) { player.currentTime = 0; player.play() }
	else { player.pause() }
      }
    }
  }
})

var app = new Vue({
  el: '#player',
  data: {
	  source: '',
	  message: 'avant cliquette'
  },
})
		</script>
        </body>
</html>
